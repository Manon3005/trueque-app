"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4661],{4661:(M,f,s)=>{s.r(f),s.d(f,{NewPageModule:()=>G});var p=s(2200),a=s(4341),n=s(9893),d=s(8132),v=s(467),c=s(2615),b=s(5032),P=s(4843),k=s(6241),j=s(1531),h=s(2024),t=s(3664),C=s(385);function w(l,r){if(1&l){const m=t.RV6();t.j41(0,"div",29),t.nrm(1,"img",30),t.j41(2,"ion-button",31),t.bIt("click",function(){const o=c.eBV(m).index,i=t.XpG();return c.Njj(i.removePreview(o))}),t.nrm(3,"ion-icon",32),t.k0s()()}if(2&l){const m=r.$implicit;t.R7$(),t.Y8G("src",m,t.B4B)}}function y(l,r){if(1&l){const m=t.RV6();t.j41(0,"div",33)(1,"label",34)(2,"input",35),t.bIt("change",function(o){c.eBV(m);const i=t.XpG();return c.Njj(i.onFileSelected(o))}),t.k0s(),t.nrm(3,"ion-icon",36),t.k0s()()}}const N=[{path:"",component:(()=>{var l;class r{constructor(){this.imageFiles=[],this.imagePreviews=[],this.maxImages=9,this.formBuilder=(0,c.WQX)(a.ok),this.productService=(0,c.WQX)(k.b),this.authService=(0,c.WQX)(j.u),this.navCtrl=(0,c.WQX)(b.q9),this.toastCtrl=(0,c.WQX)(n.K_),this.loadingCtrl=(0,c.WQX)(n.Xi),this.form=this.formBuilder.group({title:["",[a.k0.required,a.k0.maxLength(100)]],description:["",[a.k0.required,a.k0.maxLength(1e3)]],state:[h.U.NEW,a.k0.required],location:["",[a.k0.required,a.k0.maxLength(200)]]})}onFileSelected(e){const o=e.target;if(!o.files)return;const i=Array.from(o.files);for(const u of i){if(this.imageFiles.length>=this.maxImages)break;u.type.startsWith("image/")&&(this.imageFiles.push(u),this.previewFile(u))}}previewFile(e){const o=new FileReader;o.onload=()=>{this.imagePreviews.push(o.result)},o.readAsDataURL(e)}removePreview(e){this.imagePreviews.splice(e,1),this.imageFiles.splice(e,1)}submit(){var e=this;return(0,v.A)(function*(){if(e.form.invalid)e.presentToast("Por favor, complete todos los campos correctamente.","warning");else{yield(yield e.loadingCtrl.create({message:"Publicando..."})).present();try{const i=yield Promise.all(e.imageFiles.map(R=>e.toBase64(R))),g={title:e.form.value.title,descripcion:e.form.value.description,state:h.U[e.form.value.state],location:e.form.value.location,images:i};yield(0,P._)(e.productService.createProduct(g)),e.presentToast("Producto publicado con \xe9xito.","success"),e.navCtrl.navigateRoot("/account")}catch{e.presentToast("Error al publicar el producto. Int\xe9ntalo de nuevo.","danger")}}})()}toBase64(e){return new Promise((o,i)=>{const u=new FileReader;u.onload=()=>{const g=u.result.split(",")[1];o(g)},u.onerror=i,u.readAsDataURL(e)})}presentToast(e,o){var i=this;return(0,v.A)(function*(){(yield i.toastCtrl.create({message:e,duration:2500,color:o,position:"top"})).present()})()}static#t=l=()=>(this.\u0275fac=function(o){return new(o||r)},this.\u0275cmp=t.VBU({type:r,selectors:[["app-new"]],standalone:!1,decls:65,vars:10,consts:[["title","Nuevo Producto","buttonIcon","checkmark-circle-outline",1,"ion-no-border"],["side","start"],["auto-hide","false"],["routerLink","/search","routerDirection","root","routerLinkActive","selected"],["slot","start","name","search-outline"],["routerLink","/favorites","routerDirection","root","routerLinkActive","selected"],["slot","start","name","heart-outline"],["routerLink","/new-product","routerDirection","root","routerLinkActive","selected"],["slot","start","name","add-circle-outline"],["routerLink","/messages","routerDirection","root","routerLinkActive","selected"],["slot","start","name","chatbubbles-outline"],["routerLink","/account","routerDirection","root","routerLinkActive","selected"],["slot","start","name","person-outline"],[1,"ion-padding"],[1,"img-row"],["class","thumb",4,"ngFor","ngForOf"],["class","thumb add-thumb",4,"ngIf"],[3,"ngSubmit","formGroup"],["fill","outline",1,"form-item"],["position","stacked"],["formControlName","title"],["formControlName","location"],["name","location-outline","slot","end"],["formControlName","state"],[3,"value"],["formControlName","description","rows","5"],["name","document-text-outline","slot","end",1,"align-icon-top"],[1,"actions"],["type","submit",3,"disabled"],[1,"thumb"],["alt","Previsualizaci\xf3n",3,"src"],["fill","clear","shape","round",1,"remove-btn",3,"click"],["name","close-circle","slot","icon-only"],[1,"thumb","add-thumb"],[1,"file-label"],["type","file","accept","image/*","multiple","",3,"change"],["name","folder-outline"]],template:function(o,i){1&o&&(t.nrm(0,"app-header",0),t.j41(1,"ion-content")(2,"ion-split-pane")(3,"ion-menu",1)(4,"ion-content")(5,"ion-list")(6,"ion-menu-toggle",2)(7,"ion-item",3),t.nrm(8,"ion-icon",4),t.j41(9,"ion-label"),t.EFF(10,"Buscar productos"),t.k0s()(),t.j41(11,"ion-item",5),t.nrm(12,"ion-icon",6),t.j41(13,"ion-label"),t.EFF(14,"Ver tus favoritos"),t.k0s()(),t.j41(15,"ion-item",7),t.nrm(16,"ion-icon",8),t.j41(17,"ion-label"),t.EFF(18,"Crear nuevo producto"),t.k0s()(),t.j41(19,"ion-item",9),t.nrm(20,"ion-icon",10),t.j41(21,"ion-label"),t.EFF(22,"Ver tus mensajes"),t.k0s()(),t.j41(23,"ion-item",11),t.nrm(24,"ion-icon",12),t.j41(25,"ion-label"),t.EFF(26,"Ver tu cuenta"),t.k0s()()()()()(),t.j41(27,"ion-content",13)(28,"div",14),t.DNE(29,w,4,1,"div",15)(30,y,4,0,"div",16),t.k0s(),t.j41(31,"form",17),t.bIt("ngSubmit",function(){return i.submit()}),t.j41(32,"ion-item",18)(33,"ion-label",19),t.EFF(34,"T\xedtulo"),t.k0s(),t.nrm(35,"ion-input",20),t.k0s(),t.j41(36,"ion-item",18)(37,"ion-label",19),t.EFF(38,"Ubicaci\xf3n"),t.k0s(),t.nrm(39,"ion-input",21)(40,"ion-icon",22),t.k0s(),t.j41(41,"ion-item",18)(42,"ion-label",19),t.EFF(43,"Estado"),t.k0s(),t.j41(44,"ion-select",23)(45,"ion-select-option",24),t.EFF(46,"Nuevo"),t.k0s(),t.j41(47,"ion-select-option",24),t.EFF(48,"Como Nuevo"),t.k0s(),t.j41(49,"ion-select-option",24),t.EFF(50,"Buen Estado"),t.k0s(),t.j41(51,"ion-select-option",24),t.EFF(52,"Aceptable"),t.k0s(),t.j41(53,"ion-select-option",24),t.EFF(54,"Desgastado"),t.k0s(),t.j41(55,"ion-select-option",24),t.EFF(56,"Necesita Reparaci\xf3n"),t.k0s()()(),t.j41(57,"ion-item",18)(58,"ion-label",19),t.EFF(59,"Descripci\xf3n"),t.k0s(),t.nrm(60,"ion-textarea",25)(61,"ion-icon",26),t.k0s(),t.j41(62,"div",27)(63,"ion-button",28),t.EFF(64,"Publicar"),t.k0s()()()()()()),2&o&&(t.R7$(29),t.Y8G("ngForOf",i.imagePreviews),t.R7$(),t.Y8G("ngIf",i.imagePreviews.length<i.maxImages),t.R7$(),t.Y8G("formGroup",i.form),t.R7$(14),t.Y8G("value",0),t.R7$(2),t.Y8G("value",1),t.R7$(2),t.Y8G("value",2),t.R7$(2),t.Y8G("value",3),t.R7$(2),t.Y8G("value",4),t.R7$(2),t.Y8G("value",5),t.R7$(8),t.Y8G("disabled",i.form.invalid))},dependencies:[p.Sq,p.bT,a.qT,a.BC,a.cb,a.j4,a.JD,n.Jm,n.W9,n.iq,n.$w,n.uz,n.he,n.nf,n.oS,n.cA,n.Nm,n.Ip,n.HP,n.nc,n.Je,n.Gw,n.N7,d.Wk,d.wQ,C.l],styles:[".img-row[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:16px;flex-wrap:wrap}.thumb[_ngcontent-%COMP%]{width:84px;height:84px;border:1px solid var(--ion-color-medium-shade);display:flex;align-items:center;justify-content:center;position:relative;border-radius:8px}.thumb[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.add-thumb[_ngcontent-%COMP%]{cursor:pointer;background-color:var(--ion-color-light-tint)}.file-label[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;width:100%;height:100%;color:var(--ion-color-medium-shade)}.file-label[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2rem}.file-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.remove-btn[_ngcontent-%COMP%]{position:absolute;top:2px;right:2px}.form-item[_ngcontent-%COMP%]{margin-bottom:16px}.align-icon-top[_ngcontent-%COMP%]{margin-top:14px}.actions[_ngcontent-%COMP%]{margin-top:16px;display:flex;justify-content:center}"]}))}return l(),r})()}];let x=(()=>{var l;class r{static#t=l=()=>(this.\u0275fac=function(o){return new(o||r)},this.\u0275mod=t.$C({type:r}),this.\u0275inj=c.G2t({imports:[d.iI.forChild(N),d.iI]}))}return l(),r})();var E=s(6972);let G=(()=>{var l;class r{static#t=l=()=>(this.\u0275fac=function(o){return new(o||r)},this.\u0275mod=t.$C({type:r}),this.\u0275inj=c.G2t({imports:[p.MD,a.YN,a.X1,n.bv,x,E.G]}))}return l(),r})()}}]);